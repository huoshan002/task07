var baidu={City:""},Dom={sTopMenu:"#s_top_wrap",moreBtn:"#more_btn",sliderNav:"#sidebar",weatherBox:".weather-city",weatherWrap:".weather-more-box",skinWrap:".s-skin-layer"};baidu.handleEvent=function(){var e=$(".tab-contents>div");$(".tab-menu li").each(function(i,t){e.eq(1).show(),$(t).on("click",function(){$(t).addClass("current").siblings().removeClass("current"),e.eq(i).show().siblings().hide()})}),$(Dom.moreBtn).mouseenter(function(){$("#sidebar").show()}),$(Dom.sliderNav).mouseleave(function(){$("#sidebar").hide()}),$(Dom.weatherBox).mouseenter(function(){$(Dom.weatherWrap).show()}),$(Dom.weatherWrap).mouseleave(function(){$(Dom.weatherWrap).hide()})},baidu.currentCity=function(callback){$.ajax({type:"get",url:"http://webapi.amap.com/maps/ipLocation?key=608d75903d29ad471362f8c58c550daf",dataType:"text",success:function success(data){var jsonObj=eval("("+data.replace("(","").replace(")","").replace(";","")+")"),cityFullName=jsonObj.city,cityName=cityFullName.substring(0,cityFullName.length-1);baidu.City=cityName,$(".show-city-name").html(baidu.City+"："),callback&&callback(baidu.City)}})},baidu.changSkin=function(){var e=CommonUtil.getCookie("bgUrl");e&&$(".skin-wrap").css("background-image",e);var i=CommonUtil.getCookie("skin");if("0"!=i&&i){var t="<div class='skin-img-item-choose skin-bg-icon skin-bg-png24-icon'></div>",a=CommonUtil.getCookie("bgPic"),o=a.toString(),s={};s="."+o,$(s).append(t)}else baidu.defaultSkin();$("#change_skin").click(function(){$(".skin-mask").show(),$(Dom.skinWrap).show().animate({top:0,opacity:1},300)}),$(".s-skin-up, .skin-mask").click(function(){$(Dom.skinWrap).animate({top:"-288px",opacity:0},300,function(){$(Dom.skinWrap).hide(),$(".skin-mask").hide()})}),$(".s-skin-nav>li").each(function(e,i){$(i).click(function(){$(i).addClass("choose-nav").siblings().removeClass("choose-nav"),$(".s-skin-content>li").eq(e).show().siblings().hide()})});var n=$(".s-skin-border-content");n.find("p").on("mouseenter",function(){var e=$(this).closest("li").find("img").attr("src");$("#s_skin_preview_skin").attr("src",e)}),$(".s-skin-set").click(function(){baidu.defaultSkin()}),n.find("p").on("click",function(){var e="<div class='skin-img-item-choose skin-bg-icon skin-bg-png24-icon'></div>",i=$(this).closest("li");i.append(e),i.siblings().find($(".skin-img-item-choose")).remove(),i.closest(".skin-type-content").siblings().find($(".skin-img-item-choose")).remove();var t=$(this).closest("li").find("img").attr("src"),a=t.replace("-preview",""),o="url("+a+")";console.log(a),$(".skin-wrap").css("background-image",o),CommonUtil.setCookie("bgUrl",o);var s=$(this).closest("li").attr("pic");CommonUtil.setCookie("bgPic",s),baidu.useSkin()}),$(".single-slider").jRange({from:0,to:100,step:10,format:"%s",width:80,showLabels:!0,showScale:!1,onstatechange:function(){var e=$(".middle-wrap"),i=$(".single-slider").val(),t="s-opacity-"+i,a=e.attr("class"),o=a.indexOf("s-opacity-");a=-1!=o?a.substring(0,o-1)+" "+t:a+" "+t,e.attr("class",a)}})},baidu.defaultSkin=function(){$(".skin-wrap").css("background-image","url()"),CommonUtil.setCookie("bgUrl",null),$(".logo img").attr("src","images/bd_logo1.png"),CommonUtil.setCookie("logoPic","images/bd_logo1.png"),$(".search-input").addClass("search-input-default").children(".form-control").css("height","38px"),$(".search-btn").addClass("blue"),$(".top-bar").addClass("default-skin"),$(".footer-wrap, .footer-wrap a").css("color","#555"),CommonUtil.setCookie("skin","0")},baidu.useSkin=function(){$(".logo img").attr("src","images/logo_white.png"),CommonUtil.setCookie("logoPic","images/logo_white.png"),$(".search-input").removeClass("search-input-default").children(".form-control").css("height",""),$(".search-btn").removeClass("blue"),$(".top-bar").removeClass("default-skin"),$(".footer-wrap, .footer-wrap a").css("color",""),CommonUtil.setCookie("skin","1")},baidu.getWeatherData=function(e){var i=e,t="http://api.map.baidu.com/telematics/v3/weather?location="+i+"&output=json&ak=h6XnSsg19ZFbGSRoeIwUiEBvXoRd4QQQ";$.ajax({url:t,type:"GET",dataType:"jsonp",success:function(e){console.log(e);var i=DateUtil.parseDate(e.date,"yyyy-MM-dd"),t=DateUtil.fomatDate(i,"MM月dd日");$(".lunar-calendar").empty().text(t),$(".lunar-festival").empty().text(GetCNDate()),$(".everyday-mod div").remove();for(var a=e.results[0].weather_data.length,o=0;a>o;o++){var s=e.results[0].weather_data[o],n=s.date,r=s.dayPictureUrl,c=s.weather,l=s.wind,d=s.temperature;if(0==o){var u=s.date.indexOf("("),n="今天 "+s.date.slice(u);$(".weather-icon").css("background-image","url("+r+")");var m=n.indexOf("：")+1,h=n.slice(m,-1);$(".show-icon-temp").text(h);var p=e.results[0].pm25;$(".show-pollution-num").text(p);var b;switch(!0){case p>=0&&50>=p:b="优";break;case p>50&&100>=p:b="良";break;case p>100&&150>=p:b="轻度";break;case p>150&&200>=p:b="中度";break;case p>200&&300>=p:b="重度";break;case p>300:b="严重";break;default:b="无"}$(".show-pollution-name").text(b)}var g="<div class='everyday-item today'><a href='javascript:;' class='everyday-link'><p class='everyday-title'>"+n+"</p><img src=' "+r+"' class='everyday-icon'><p class='everyday-temp'>"+d+"</p><p class='everyday-condition'>"+c+"</p><p class='everyday-wind'>"+l+"</p></a></div>";$(".everyday-mod").append(g)}$(".everyday-item:first-child").addClass("is-today")}})},baidu.setCurrentCity=function(){$(".lunar-setting-btn").click(function(){$(".setweather-setting").show()}),$(".setting-cancel").click(function(){$(".setweather-setting").hide()}),$(".setting-save").click(function(){var e=$("#choose_location option:selected").val();baidu.getWeatherData(e),CommonUtil.setCookie("currentCity",e),baidu.City=e,baidu.getWeatherData(baidu.City),$(".show-city-name").html(baidu.City+"："),$(".setweather-setting").hide()})},baidu.weatherInit=function(){var e=CommonUtil.getCookie("currentCity");e&&""!=e?(baidu.City=e,baidu.getWeatherData(baidu.City),$(".show-city-name").html(baidu.City+"：")):baidu.currentCity(baidu.getWeatherData),baidu.setCurrentCity()};var init=function(){baidu.handleEvent(),baidu.changSkin(),baidu.weatherInit()};$(function(){init(),$(window).scroll(function(){$("body").scrollTop()>200?$("#s_top_wrap").show():$("#s_top_wrap").hide()}),$("#top_feed").click(function(){$(window).scrollTop(0)}),$(window).scroll(function(){var e=$("body").scrollTop();e>=200?$("#top_feed").show():$("#top_feed").hide()}),$(".news-title").mouseenter(function(){$(this).children(".more-info").show()}),$(".news-title").mouseleave(function(){$(this).children(".more-info").hide()})});